!function r(o,i,n){function a(e,t){if(!i[e]){if(!o[e]){var s="function"==typeof require&&require;if(!t&&s)return s(e,!0);if(h)return h(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}s=i[e]={exports:{}},o[e][0].call(s.exports,function(t){return a(o[e][1][t]||t)},s,s.exports,r,o,i,n)}return i[e].exports}for(var h="function"==typeof require&&require,t=0;t<n.length;t++)a(n[t]);return a}({1:[function(s,t,e){!function(e){!function(){var t=this.SENSORLIB||{REVISION:"0.0.1"};Object.assign(t,s("./sensors")),Object.assign(t,s("./error")),Object.assign(t,s("./actuators")),Object.assign(t,s("./util")),e.SENSORLIB=t}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./actuators":6,"./error":8,"./sensors":19,"./util":21}],2:[function(t,e,s){var r=t("./Subscriber.js");const o=t("../error/NotSupportedError");class i extends r{constructor(t,e){if(super(t,e),this.topic.messageType="std_msgs/Bool",!("mediaDevices"in navigator))throw new o("Browser does not support this feature");navigator.mediaDevices.enumerateDevices().then(t=>{t=t.filter(t=>"videoinput"===t.kind);if(0===t.length)throw Error("No camera found on this device");t=t[t.length-1];navigator.mediaDevices.getUserMedia({video:{deviceId:t.deviceId,facingMode:["user","environment"],height:{ideal:1080},width:{ideal:1920}}}).then(t=>{this.track=t.getVideoTracks()[0],this.imageCapture=new ImageCapture(this.track)})})}onMessage(t){this.imageCapture.getPhotoCapabilities().then(()=>{this.track.applyConstraints({advanced:[{torch:t.data}]})})}}e.exports=i},{"../error/NotSupportedError":7,"./Subscriber.js":4}],3:[function(t,e,s){var r=t("./Subscriber");const a=t("../error/NotSupportedError");class i extends r{constructor(t,e,s,r=!0){if(super(t,e),!(s instanceof window.HTMLCanvasElement))throw new TypeError("canvas argument must be of type HTMLCanvasElement");this.topic.messageType="sensor_msgs/CompressedImage",this.canvas=s,this.compressed=r,this.topic.messageType=this.getMessageType()}getMessageType(){return this.compressed?"sensor_msgs/CompressedImage":"sensor_msgs/Image"}static createImageDataUrl(t,e){return"data:image/"+t+";base64,"+e}drawImage(t){const e=this.canvas,s=e.getContext("2d"),r=new window.Image;r.onload=function(){s.drawImage(r,0,0,e.width,e.height)},r.onerror=function(){throw Error("could not draw image")},r.src=t}static convertImageData(t,e,s){if("rgb8"!==e&&"rgba8"!==e)throw new a("Subscriber only supports uncompressed images in rgb8 or rgba8 format");var r="rgba8"===e;const o=window.atob(t),i=new Uint8ClampedArray(4*s);let n=0;for(let t=0;t<i.length;t++)r||t%4!=3?(i[t]=o.charCodeAt(n),n++):i[t]=255;return i}onMessage(t){let e;if(this.compressed)e=i.createImageDataUrl(t.format,t.data);else{const r=document.createElement("canvas"),o=(r.width=t.width,r.height=t.height,r.getContext("2d"));var s=i.convertImageData(t.data,t.encoding,t.width*t.height),s=new window.ImageData(s,t.width,t.height);o.putImageData(s,0,0),e=r.toDataURL()}this.drawImage(e)}}e.exports=i},{"../error/NotSupportedError":7,"./Subscriber":4}],4:[function(t,e,s){e.exports=class{constructor(t,e){if(!(t instanceof ROSLIB.Ros))throw new TypeError("ros argument was not of type ROSLIB.Ros");if("string"!=typeof e)throw new TypeError("topicName argument was not of type String");this.ros=t,this.topicName=e,this.topic=new ROSLIB.Topic({ros:this.ros,name:this.topicName}),this.started=!1,this.onMessage=this.onMessage.bind(this)}onMessage(t){throw Error("onMessage method not defined!")}start(){if(this.started)throw new Error("Subscriber already started");this.topic.subscribe(this.onMessage),this.started=!0}stop(){if(!this.started)throw new Error("Subscriber did not start yet");this.topic.unsubscribe(this.onMessage),this.started=!1}}},{}],5:[function(t,e,s){t=t("./Subscriber.js");class r extends t{constructor(t,e,s){if(super(t,e),!(s instanceof window.HTMLElement))throw new TypeError("HTMLElement argument was not of type HTMLElement");this.topic.messageType="std_msgs/String",this.HTMLElement=s}onMessage(t){this.HTMLElement.innerHTML=t.data}}e.exports=r},{"./Subscriber.js":4}],6:[function(t,e,s){e.exports={TextSubscriber:t("./TextSubscriber"),ImageSubscriber:t("./ImageSubscriber"),FlashlightSubscriber:t("./FlashlightSubscriber")}},{"./FlashlightSubscriber":2,"./ImageSubscriber":3,"./TextSubscriber":5}],7:[function(t,e,s){class r extends Error{constructor(t){super(t),this.name="NotSupportedError"}}e.exports=r},{}],8:[function(t,e,s){e.exports={NotSupportedError:t("./NotSupportedError")}},{"./NotSupportedError":7}],9:[function(t,e,s){t=t("./SensorPublisher.js");class r extends t{constructor(t,e,s){if(super(t,e),!(s instanceof window.HTMLButtonElement))throw new TypeError("button argument was not of type HTMLButtonElement");this.topic.messageType="std_msgs/Bool",this.button=s;let r=!1;this.onMouseDown=function(t){t.preventDefault(),r||(r=!0,t=this.createBoolMsg(!0),this.topic.publish(t))}.bind(this),this.onMouseUp=function(t){t.preventDefault(),r&&(r=!1,t=this.createBoolMsg(!1),this.topic.publish(t))}.bind(this)}createBoolMsg(t){return new ROSLIB.Message({data:t})}start(){super.start(),this.button.addEventListener("mousedown",this.onMouseDown),this.button.addEventListener("touchstart",this.onMouseDown),this.button.addEventListener("mouseup",this.onMouseUp),this.button.addEventListener("mouseleave",this.onMouseUp),this.button.addEventListener("touchend",this.onMouseUp),this.button.addEventListener("touchcancel",this.onMouseUp)}stop(){super.stop(),this.button.removeEventListener("mousedown",this.onMouseDown),this.button.removeEventListener("touchstart",this.onMouseDown),this.button.removeEventListener("mouseup",this.onMouseUp),this.button.removeEventListener("mouseleave",this.onMouseUp),this.button.removeEventListener("touchend",this.onMouseUp),this.button.removeEventListener("touchcancel",this.onMouseUp)}}e.exports=r},{"./SensorPublisher.js":16}],10:[function(t,e,s){t=t("./IntervalPublisher");class n extends t{constructor(t,e,s,r){if(super(t,e),!(s instanceof window.HTMLVideoElement))throw new TypeError("camera argument was not of type HTMLVideoElement");if(!(r instanceof window.HTMLCanvasElement))throw new TypeError("canvas argument was not of type HTMLCanvasElement");this.camera=s,this.canvas=r,this.topic.messageType="sensor_msgs/CompressedImage"}createSnapshot(){this.canvas.getContext("2d").drawImage(this.camera,0,0,this.canvas.width,this.canvas.height);const t=this.canvas.toDataURL("image/jpeg");var e=new ROSLIB.Message({format:"jpeg",data:t.replace("data:image/jpeg;base64,","")});this.topic.publish(e)}start(){if(!this.camera.srcObject)throw new Error("No video source found.");super.start()}static readFromConfig(t,e){var s=document.getElementById(e.cameraId),r=document.getElementById(e.canvasId),o="mirte/phone_camera/"+e.name;const i=new n(t,o,s,r);return i.start(),i.setPublishFrequency(e.frequency),i}}e.exports=n},{"./IntervalPublisher":14}],11:[function(t,e,s){var r=t("./IntervalPublisher.js");const o=t("../error/NotSupportedError");class i extends r{constructor(t,e,s=90,r=0){if(super(t,e),"number"!=typeof s||"number"!=typeof r)throw new TypeError("Coordinates were not of type Number");if(90<s||s<-90||180<r||r<-180)throw new Error("Range of given coordinates is invalid");if(this.topic.messageType="std_msgs/Int32",this.compass=0,this.lat=s,this.lng=r,this.orientationReady=!1,this.gpsReady=!1,this.oldCompass=null,this.watchId=-1,!window.navigator.geolocation)throw new o("Unable to create GPSPublisher, Geolocation API not supported")}start(){super.start(),window.addEventListener("deviceorientationabsolute",t=>{this.onReadOrientation(t)},!0),this.watchId=window.navigator.geolocation.watchPosition(this.locationHandler.bind(this),t=>{throw Error("failed to watch position")})}stop(){super.stop(),window.navigator.geolocation.clearWatch(this.watchId)}onError(t){throw console.log("Error: "+t),Error("ERROR!")}calcDegreeToPoint(t,e){if(t===this.lat&&e===this.lng)return 0;var s=this.lat*Math.PI/180,r=this.lng*Math.PI/180,t=t*Math.PI/180,e=e*Math.PI/180,s=180/Math.PI*Math.atan2(Math.sin(r-e),Math.cos(t)*Math.tan(s)-Math.sin(t)*Math.cos(r-e));let o=Math.round(s);return o=360===(o+=180)?0:o}locationHandler(t){var{latitude:t,longitude:e}=t.coords;this.compass=this.calcDegreeToPoint(t,e),this.gpsReady=!0}onReadOrientation(t){this.alpha=Math.round(Math.abs(t.alpha-360)),this.orientationReady=!0}accountForRotation(){let t=this.compass-this.alpha;return t=t<0?360+t:t}createSnapshot(){if(!this.orientationReady||!this.gpsReady)throw Error("Orientation is not read yet!");var t;this.compass=this.accountForRotation(),this.compass!==this.oldCompass&&(this.oldCompass=this.compass,t=new ROSLIB.Message({data:this.compass}),this.topic.publish(t))}static readFromConfig(t,e){var s="mirte/phone_gps_declination/"+e.name;const r=new i(t,s);return r.start(),r.setPublishFrequency(e.frequency),r}}e.exports=i},{"../error/NotSupportedError":7,"./IntervalPublisher.js":14}],12:[function(t,e,s){var r=t("./IntervalPublisher");const o=t("../error/NotSupportedError");class i extends r{constructor(t,e,s=1){if(super(t,e,s),this.topic.messageType=i.messageType,this.watchId=-1,this.position=void 0,!window.navigator.geolocation)throw new o("Unable to create GPSPublisher, Geolocation API not supported")}static get messageType(){return"sensor_msgs/NavSatFix"}static isSamePosition(t,e){t=t.coords,e=e.coords;return t.latitude===e.latitude&&t.longitude===e.longitude}start(){super.start();var t=function(t){this.position=t}.bind(this);this.watchId=window.navigator.geolocation.watchPosition(t,function(t){throw t})}stop(){super.stop(),window.navigator.geolocation.clearWatch(this.watchId)}static createNavSatMessage(t){return new ROSLIB.Message({latitude:t.latitude,longitude:t.longitude,position_covariance_type:0})}createSnapshot(){var t;!this.position||this.lastPublishedPosition&&i.isSamePosition(this.position,this.lastPublishedPosition)||(t=this.position.coords,t=i.createNavSatMessage(t),this.topic.publish(t),this.lastPublishedPosition=this.position)}static readFromConfig(t,e){var s="mirte/phone_gps/"+e.name;const r=new i(t,s);return r.start(),r.setPublishFrequency(e.frequency),r}}e.exports=i},{"../error/NotSupportedError":7,"./IntervalPublisher":14}],13:[function(t,e,s){var r=t("./IntervalPublisher.js");const o=t("../util/MathUtils.js");class i extends r{constructor(t,e){super(t,e,5),this.topic.messageType="sensor_msgs/Imu",this.orientationReady=!1,this.motionReady=!1,this.alpha=0,this.beta=0,this.gamma=0,this.valpha=0,this.vbeta=0,this.vgamma=0,window.addEventListener("deviceorientation",t=>{this.onReadOrientation.bind(this)(t)}),window.DeviceMotionEvent?window.addEventListener("devicemotion",t=>{this.onReadMotion.bind(this)(t)}):window.alert("acceleration not supported!")}onReadOrientation(t){this.alpha=parseFloat(t.alpha),this.beta=parseFloat(t.beta),this.gamma=parseFloat(t.gamma),this.orientationReady=!0}onReadMotion(t){var e=t.rotationRate,t=t.acceleration;this.x=t.x,this.y=t.y,this.z=t.z,this.valpha=e.alpha,this.vbeta=e.beta,this.vgamma=e.gamma,this.motionReady=!0}createSnapshot(){var t=(this.alpha+360)/360*2*Math.PI%(2*Math.PI),e=(this.beta+360)/360*2*Math.PI%(2*Math.PI),s=(this.gamma+360)/360*2*Math.PI%(2*Math.PI),e=o.quatFromEuler(e,s,t),s=new ROSLIB.Message({header:{frame_id:"world"},orientation:{x:e.x,y:e.y,z:e.z,w:e.w},orientation_covariance:[this.orientationReady?0:-1,0,0,0,0,0,0,0,0],angular_velocity:{x:this.vbeta,y:this.vgamma,z:this.valpha},angular_velocity_covariance:[this.motionReady?0:-1,0,0,0,0,0,0,0,0],linear_acceleration:{x:this.x,y:this.y,z:this.z},linear_acceleration_covariance:[this.motionReady?0:-1,0,0,0,0,0,0,0,0]});this.topic.publish(s)}static readFromConfig(t,e){var s="mirte/phone_imu/"+e.name;const r=new i(t,s);return r.start(),r.setPublishFrequency(e.frequency),r}}e.exports=i},{"../util/MathUtils.js":20,"./IntervalPublisher.js":14}],14:[function(t,e,s){t=t("./SensorPublisher");class r extends t{constructor(t,e,s=10){if(super(t,e),s<=0)throw new Error("Cannot construct with frequency "+s);this.freq=s}createSnapshot(){throw Error("create snapshot is yet to be implemented!")}start(){super.start();var t=1e3/this.freq,e=this.createSnapshot.bind(this);this.timer=setInterval(e,t)}stop(){super.stop(),clearInterval(this.timer)}setPublishFrequency(t){if(t<=0)throw new Error("Publisher cannot publish on frequency "+t+" Hz, frequency remained "+this.freq);this.freq=t,this.started&&(this.stop(),this.start())}}e.exports=r},{"./SensorPublisher":16}],15:[function(t,e,s){t=t("./IntervalPublisher.js");class o extends t{constructor(t,e){super(t,e),this.topic.messageType="std_msgs/Int32",this.orientationReady=!1,this.oldCompass=null}start(){super.start(),window.addEventListener("deviceorientationabsolute",t=>{this.onReadOrientation(t)},!0)}onError(t){throw console.log("Error: "+t),Error("ERROR!")}onReadOrientation(t){this.alpha=Math.round(Math.abs(t.alpha-360)),this.orientationReady=!0}createSnapshot(){if(!this.orientationReady)throw Error("Orientation is not read yet!");var t=this.alpha;t!==this.oldCompass&&(this.oldCompass=t,t=new ROSLIB.Message({data:t}),this.topic.publish(t))}static readFromConfig(t,e){var s="mirte/phone_magnetic_declination/"+e.name;const r=new o(t,s);return r.start(),r.setPublishFrequency(e.frequency),r}}e.exports=o},{"./IntervalPublisher.js":14}],16:[function(t,e,s){e.exports=class{constructor(t,e){if(!(t instanceof ROSLIB.Ros))throw new TypeError("ros argument was not of type ROSLIB.Ros");if("string"!=typeof e)throw new TypeError("topicName argument was not of type String");this.ros=t,this.topicName=e,this.topic=new ROSLIB.Topic({ros:this.ros,name:this.topicName}),this.started=!1}onError(t){throw Error("onError method not defined!")}onReadData(t){throw Error("onReadData method not defined!")}start(){if(this.started)throw new Error("Publisher already started");this.started=!0}stop(){if(!this.started)throw new Error("Publisher did not start yet");this.started=!1}setPublishFrequency(){throw Error("setPublishFrequency method not defined!")}static readFromConfig(t,e){throw Error("readFromConfig method not defined!")}}},{}],17:[function(t,e,s){t=t("./IntervalPublisher.js");class r extends t{constructor(t,e,s){if(super(t,e),!(s instanceof window.HTMLInputElement))throw new TypeError("slider argument was not of type HTMLInputElement");if("range"!==s.type)throw new TypeError("slider argument does not have type range");this.topic.messageType="std_msgs/Int32",this.slider=s,this.oldValue=null}createInt32Msg(t){return new ROSLIB.Message({data:t})}createSnapshot(){var t=parseInt(this.slider.value);t!==this.oldValue&&(this.oldValue=t,t=this.createInt32Msg(t),this.topic.publish(t))}}e.exports=r},{"./IntervalPublisher.js":14}],18:[function(t,e,s){t=t("./SensorPublisher.js");class r extends t{constructor(t,e,s,r){if(super(t,e),this.topic.messageType="std_msgs/String",this.options=void 0===r?{}:r,this.options.onEnter=void 0===this.options.onEnter||this.options.onEnter,this.options.clearOnPublish=void 0===this.options.clearOnPublish||this.options.clearOnPublish,!(s instanceof window.HTMLInputElement))throw new TypeError("input element was not of type HTMLInputElement");if(null!==s.getAttribute("type")&&"text"!==s.getAttribute("type"))throw new TypeError('Input element has to have type attribute "text"');this.inputElement=s,this.onInput=function(){this.publishMessage()}.bind(this),this.onKeyUp=function(t){"Enter"===t.key&&this.publishMessage()}.bind(this)}publishMessage(){var t=this.createStrMsg(this.inputElement.value);this.topic.publish(t),this.options.clearOnPublish&&(this.inputElement.value="")}createStrMsg(t){return new ROSLIB.Message({data:t})}start(){super.start(),this.options.onEnter?this.inputElement.addEventListener("keyup",this.onKeyUp):this.inputElement.addEventListener("input",this.onInput)}stop(){super.stop(),this.options.onEnter?this.inputElement.removeEventListener("keyup",this.onKeyUp):this.inputElement.removeEventListener("input",this.onInput)}}e.exports=r},{"./SensorPublisher.js":16}],19:[function(t,e,s){e.exports={ButtonPublisher:t("./ButtonPublisher"),IMUPublisher:t("./IMUPublisher"),SliderPublisher:t("./SliderPublisher"),CameraPublisher:t("./CameraPublisher"),TextPublisher:t("./TextPublisher"),GPSPublisher:t("./GPSPublisher"),MagneticDeclinationPublisher:t("./MagneticDeclinationPublisher"),GPSDeclinationPublisher:t("./GPSDeclinationPublisher")}},{"./ButtonPublisher":9,"./CameraPublisher":10,"./GPSDeclinationPublisher":11,"./GPSPublisher":12,"./IMUPublisher":13,"./MagneticDeclinationPublisher":15,"./SliderPublisher":17,"./TextPublisher":18}],20:[function(t,e,s){e.exports={quatFromEuler:function(t,e,s){const r=Math.cos,o=Math.sin;var i=r(t/2),n=r(e/2),a=r(s/2),t=o(t/2),e=o(e/2),s=o(s/2);return{x:t*n*a+i*e*s,y:i*e*a-t*n*s,z:i*n*s+t*e*a,w:i*n*a-t*e*s}}}},{}],21:[function(t,e,s){Object.assign(e.exports,t("./mirteUtil")),Object.assign(e.exports,t("./MathUtils"))},{"./MathUtils":20,"./mirteUtil":22}],22:[function(t,e,s){var r=t("../sensors/GPSPublisher"),o=t("../sensors/IMUPublisher"),i=t("../sensors/MagneticDeclinationPublisher"),n=t("../sensors/GPSDeclinationPublisher"),t=t("../sensors/CameraPublisher");const h={phone_imu:o.readFromConfig,phone_magnetic_declination:i.readFromConfig,phone_gps:r.readFromConfig,phone_gps_declination:n.readFromConfig,phone_camera:t.readFromConfig};e.exports={readSensorsFromConfig:function(t,e){const s=new Map;for(const i of Object.keys(h)){var r=t[i];if(r)for(const n of Object.values(r)){const a=h[i];var o=a(e,n);s.set(o.topic.name,o)}}return s}}},{"../sensors/CameraPublisher":10,"../sensors/GPSDeclinationPublisher":11,"../sensors/GPSPublisher":12,"../sensors/IMUPublisher":13,"../sensors/MagneticDeclinationPublisher":15}]},{},[1]);